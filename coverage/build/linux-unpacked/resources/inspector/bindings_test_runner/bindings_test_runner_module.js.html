<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for build/linux-unpacked/resources/inspector/bindings_test_runner/bindings_test_runner_module.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../../../prettify.css" />
    <link rel="stylesheet" href="../../../../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../../../../index.html">All files</a> / <a href="index.html">build/linux-unpacked/resources/inspector/bindings_test_runner</a> bindings_test_runner_module.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/382</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/110</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/89</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/55</span>
      </div>
    </div>
    <p class="quiet">
      Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
    </p>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
<a name='L2'></a><a href='#L2'>2</a>
<a name='L3'></a><a href='#L3'>3</a>
<a name='L4'></a><a href='#L4'>4</a>
<a name='L5'></a><a href='#L5'>5</a>
<a name='L6'></a><a href='#L6'>6</a>
<a name='L7'></a><a href='#L7'>7</a>
<a name='L8'></a><a href='#L8'>8</a>
<a name='L9'></a><a href='#L9'>9</a>
<a name='L10'></a><a href='#L10'>10</a>
<a name='L11'></a><a href='#L11'>11</a>
<a name='L12'></a><a href='#L12'>12</a>
<a name='L13'></a><a href='#L13'>13</a>
<a name='L14'></a><a href='#L14'>14</a>
<a name='L15'></a><a href='#L15'>15</a>
<a name='L16'></a><a href='#L16'>16</a>
<a name='L17'></a><a href='#L17'>17</a>
<a name='L18'></a><a href='#L18'>18</a>
<a name='L19'></a><a href='#L19'>19</a>
<a name='L20'></a><a href='#L20'>20</a>
<a name='L21'></a><a href='#L21'>21</a>
<a name='L22'></a><a href='#L22'>22</a>
<a name='L23'></a><a href='#L23'>23</a>
<a name='L24'></a><a href='#L24'>24</a>
<a name='L25'></a><a href='#L25'>25</a>
<a name='L26'></a><a href='#L26'>26</a>
<a name='L27'></a><a href='#L27'>27</a>
<a name='L28'></a><a href='#L28'>28</a>
<a name='L29'></a><a href='#L29'>29</a>
<a name='L30'></a><a href='#L30'>30</a>
<a name='L31'></a><a href='#L31'>31</a>
<a name='L32'></a><a href='#L32'>32</a>
<a name='L33'></a><a href='#L33'>33</a>
<a name='L34'></a><a href='#L34'>34</a>
<a name='L35'></a><a href='#L35'>35</a>
<a name='L36'></a><a href='#L36'>36</a>
<a name='L37'></a><a href='#L37'>37</a>
<a name='L38'></a><a href='#L38'>38</a>
<a name='L39'></a><a href='#L39'>39</a>
<a name='L40'></a><a href='#L40'>40</a>
<a name='L41'></a><a href='#L41'>41</a>
<a name='L42'></a><a href='#L42'>42</a>
<a name='L43'></a><a href='#L43'>43</a>
<a name='L44'></a><a href='#L44'>44</a>
<a name='L45'></a><a href='#L45'>45</a>
<a name='L46'></a><a href='#L46'>46</a>
<a name='L47'></a><a href='#L47'>47</a>
<a name='L48'></a><a href='#L48'>48</a>
<a name='L49'></a><a href='#L49'>49</a>
<a name='L50'></a><a href='#L50'>50</a>
<a name='L51'></a><a href='#L51'>51</a>
<a name='L52'></a><a href='#L52'>52</a>
<a name='L53'></a><a href='#L53'>53</a>
<a name='L54'></a><a href='#L54'>54</a>
<a name='L55'></a><a href='#L55'>55</a></td><td class="line-coverage quiet"><span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js"><span class="cstat-no" title="statement not covered" >BindingsTestRunner.cleanupURL=<span class="fstat-no" title="function not covered" >fu</span>nction(url){<span class="cstat-no" title="statement not covered" >if(!url.startsWith('debugger://'))</span></span>
<span class="cstat-no" title="statement not covered" >return url;<span class="cstat-no" title="statement not covered" >r</span>eturn url.replace(/VM\d+/g,'VM[XXX]');}</span>;<span class="cstat-no" title="statement not covered" >BindingsTestRunner.dumpWorkspace=<span class="fstat-no" title="function not covered" >fu</span>nction(previousSnapshot){const uiSourceCodes=<span class="cstat-no" title="statement not covered" >Workspace.workspace.uiSourceCodes().slice();</span>let urls=<span class="cstat-no" title="statement not covered" >uiSourceCodes.map(<span class="fstat-no" title="function not covered" >co</span>de=&gt;<span class="cstat-no" title="statement not covered" >code.url())</span>;<span class="cstat-no" title="statement not covered" ></span>urls=urls.map(BindingsTestRunner.cleanupURL);<span class="cstat-no" title="statement not covered" >u</span>rls.sort(String.caseInsensetiveComparator);c</span>onst isAdded=<span class="cstat-no" title="statement not covered" >new Array(urls.length).fill(false);</span>let removedLines=<span class="cstat-no" title="statement not covered" >[];<span class="cstat-no" title="statement not covered" ></span>if(previousSnapshot){const diff=<span class="cstat-no" title="statement not covered" >Diff.Diff.lineDiff(previousSnapshot,urls);</span>const removedEntries=<span class="cstat-no" title="statement not covered" >diff.filter(<span class="fstat-no" title="function not covered" >en</span>try=&gt;<span class="cstat-no" title="statement not covered" >entry[0]===Diff.Diff.Operation.Delete)</span>.map(<span class="fstat-no" title="function not covered" >en</span>try=&gt;<span class="cstat-no" title="statement not covered" >entry[1])</span>;<span class="cstat-no" title="statement not covered" ></span>removedLines=[].concat.apply([],removedEntries);l</span>et index=<span class="cstat-no" title="statement not covered" >0;<span class="cstat-no" title="statement not covered" ></span>for(const entry of diff){<span class="cstat-no" title="statement not covered" >if(entry[0]===Diff.Diff.Operation.Delete)</span></span></span></span>
<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >i</span>f(entry[0]===Diff.Diff.Operation.Equal){<span class="cstat-no" title="statement not covered" >index+=entry[1].length;<span class="cstat-no" title="statement not covered" >c</span>ontinue;}</span></span>
<span class="cstat-no" title="statement not covered" >for(const line of entry[1])</span>
<span class="cstat-no" title="statement not covered" >isAdded[index++]=true;}</span>
const addedEntries=<span class="cstat-no" title="statement not covered" >diff.filter(<span class="fstat-no" title="function not covered" >en</span>try=&gt;<span class="cstat-no" title="statement not covered" >entry[0]===Diff.Diff.Operation.Insert)</span>.map(<span class="fstat-no" title="function not covered" >en</span>try=&gt;<span class="cstat-no" title="statement not covered" >entry[1])</span>;<span class="cstat-no" title="statement not covered" ></span>addedLines=[].concat.apply([],addedEntries);}</span>
<span class="cstat-no" title="statement not covered" >TestRunner.addResult(`Removed: ${removedLines.length} uiSourceCodes`);<span class="cstat-no" title="statement not covered" >f</span>or(const url of removedLines)</span>
<span class="cstat-no" title="statement not covered" >TestRunner.addResult('[-] '+url);<span class="cstat-no" title="statement not covered" >T</span>estRunner.addResult(`Workspace: ${urls.length} uiSourceCodes.`);<span class="cstat-no" title="statement not covered" >f</span>or(let i=0;i&lt;urls.length;++i){const url=<span class="cstat-no" title="statement not covered" >urls[i];</span>const prefix=(<span class="cstat-no" title="statement not covered" >isAdded[i]?'[+] ':'    ')</span>;<span class="cstat-no" title="statement not covered" >TestRunner.addResult(prefix+url);}</span></span>
<span class="cstat-no" title="statement not covered" >return urls;}</span>;<span class="cstat-no" title="statement not covered" >BindingsTestRunner.attachFrame=<span class="fstat-no" title="function not covered" >fu</span>nction(frameId,url,evalSourceURL){let evalSource=<span class="cstat-no" title="statement not covered" >`(${attachFrame.toString()})('${frameId}', '${url}')`;<span class="cstat-no" title="statement not covered" ></span>if(evalSourceURL)</span></span>
<span class="cstat-no" title="statement not covered" >evalSource+='//# sourceURL='+evalSourceURL;<span class="cstat-no" title="statement not covered" >r</span>eturn TestRunner.evaluateInPageAsync(evalSource);f</span>unction <span class="fstat-no" title="function not covered" >attachFrame(</span>frameId,url){const frame=<span class="cstat-no" title="statement not covered" >document.createElement('iframe');<span class="cstat-no" title="statement not covered" ></span>frame.src=url;<span class="cstat-no" title="statement not covered" >f</span>rame.id=frameId;<span class="cstat-no" title="statement not covered" >d</span>ocument.body.appendChild(frame);<span class="cstat-no" title="statement not covered" >r</span>eturn new Promise(<span class="fstat-no" title="function not covered" >x=</span>&gt;<span class="cstat-no" title="statement not covered" >frame.onload=x)</span>;}</span>};<span class="cstat-no" title="statement not covered" >BindingsTestRunner.detachFrame=<span class="fstat-no" title="function not covered" >fu</span>nction(frameId,evalSourceURL){let evalSource=<span class="cstat-no" title="statement not covered" >`(${detachFrame.toString()})('${frameId}')`;<span class="cstat-no" title="statement not covered" ></span>if(evalSourceURL)</span></span>
<span class="cstat-no" title="statement not covered" >evalSource+='//# sourceURL='+evalSourceURL;<span class="cstat-no" title="statement not covered" >r</span>eturn TestRunner.evaluateInPageAnonymously(evalSource);f</span>unction <span class="fstat-no" title="function not covered" >detachFrame(</span>frameId){const frame=<span class="cstat-no" title="statement not covered" >document.getElementById(frameId);<span class="cstat-no" title="statement not covered" ></span>frame.remove();}</span>};<span class="cstat-no" title="statement not covered" >BindingsTestRunner.navigateFrame=<span class="fstat-no" title="function not covered" >fu</span>nction(frameId,navigateURL,evalSourceURL){let evalSource=<span class="cstat-no" title="statement not covered" >`(${navigateFrame.toString()})('${frameId}', '${navigateURL}')`;<span class="cstat-no" title="statement not covered" ></span>if(evalSourceURL)</span></span>
<span class="cstat-no" title="statement not covered" >evalSource+='//# sourceURL='+evalSourceURL;<span class="cstat-no" title="statement not covered" >r</span>eturn TestRunner.evaluateInPageAsync(evalSource);f</span>unction <span class="fstat-no" title="function not covered" >navigateFrame(</span>frameId,url){const frame=<span class="cstat-no" title="statement not covered" >document.getElementById(frameId);<span class="cstat-no" title="statement not covered" ></span>frame.src=url;<span class="cstat-no" title="statement not covered" >r</span>eturn new Promise(<span class="fstat-no" title="function not covered" >x=</span>&gt;<span class="cstat-no" title="statement not covered" >frame.onload=x)</span>;}</span>};<span class="cstat-no" title="statement not covered" >BindingsTestRunner.attachShadowDOM=<span class="fstat-no" title="function not covered" >fu</span>nction(id,templateSelector,evalSourceURL){let evalSource=<span class="cstat-no" title="statement not covered" >`(${createShadowDOM.toString()})('${id}', '${templateSelector}')`;<span class="cstat-no" title="statement not covered" ></span>if(evalSourceURL)</span></span>
<span class="cstat-no" title="statement not covered" >evalSource+='//# sourceURL='+evalSourceURL;<span class="cstat-no" title="statement not covered" >r</span>eturn TestRunner.evaluateInPageAnonymously(evalSource);f</span>unction <span class="fstat-no" title="function not covered" >createShadowDOM(</span>id,templateSelector){const shadowHost=<span class="cstat-no" title="statement not covered" >document.createElement('div');<span class="cstat-no" title="statement not covered" ></span>shadowHost.setAttribute('id',id);c</span>onst shadowRoot=<span class="cstat-no" title="statement not covered" >shadowHost.attachShadow({mode:'open'});</span>const t=<span class="cstat-no" title="statement not covered" >document.querySelector(templateSelector);</span>const instance=<span class="cstat-no" title="statement not covered" >t.content.cloneNode(true);<span class="cstat-no" title="statement not covered" ></span>shadowRoot.appendChild(instance);<span class="cstat-no" title="statement not covered" >d</span>ocument.body.appendChild(shadowHost);}</span>};<span class="cstat-no" title="statement not covered" >BindingsTestRunner.detachShadowDOM=<span class="fstat-no" title="function not covered" >fu</span>nction(id,evalSourceURL){let evalSource=<span class="cstat-no" title="statement not covered" >`(${removeShadowDOM.toString()})('${id}')`;<span class="cstat-no" title="statement not covered" ></span>if(evalSourceURL)</span></span>
<span class="cstat-no" title="statement not covered" >evalSource+='//# sourceURL='+evalSourceURL;<span class="cstat-no" title="statement not covered" >r</span>eturn TestRunner.evaluateInPageAnonymously(evalSource);f</span>unction <span class="fstat-no" title="function not covered" >removeShadowDOM(</span>id){<span class="cstat-no" title="statement not covered" >document.querySelector('#'+id).remove();}</span>};<span class="cstat-no" title="statement not covered" >BindingsTestRunner.waitForStyleSheetRemoved=<span class="fstat-no" title="function not covered" >fu</span>nction(urlSuffix){let fulfill;const promise=<span class="cstat-no" title="statement not covered" >new Promise(<span class="fstat-no" title="function not covered" >x=</span>&gt;<span class="cstat-no" title="statement not covered" >fulfill=x)</span>;<span class="cstat-no" title="statement not covered" ></span>TestRunner.cssModel.addEventListener(SDK.CSSModel.Events.StyleSheetRemoved,onStyleSheetRemoved);<span class="cstat-no" title="statement not covered" >r</span>eturn promise;f</span>unction <span class="fstat-no" title="function not covered" >onStyleSheetRemoved(</span>event){const styleSheetHeader=<span class="cstat-no" title="statement not covered" >event.data;<span class="cstat-no" title="statement not covered" ></span>if(!styleSheetHeader.resourceURL().endsWith(urlSuffix))</span></span>
<span class="cstat-no" title="statement not covered" >return;<span class="cstat-no" title="statement not covered" >T</span>estRunner.cssModel.removeEventListener(SDK.CSSModel.Events.StyleSheetRemoved,onStyleSheetRemoved);<span class="cstat-no" title="statement not covered" >f</span>ulfill();}</span>};<span class="cstat-no" title="statement not covered" >TestRunner.addSniffer(Bindings.CompilerScriptMapping.prototype,'_sourceMapAttachedForTest',onSourceMap,true);<span class="cstat-no" title="statement not covered" >T</span>estRunner.addSniffer(Bindings.SASSSourceMapping.prototype,'_sourceMapAttachedForTest',onSourceMap,true);c</span>onst sourceMapCallbacks=<span class="cstat-no" title="statement not covered" >new Map();</span>function <span class="fstat-no" title="function not covered" >onSourceMap(</span>sourceMap){<span class="cstat-no" title="statement not covered" >for(const urlSuffix of sourceMapCallbacks.keys()){<span class="cstat-no" title="statement not covered" >if(sourceMap.url().endsWith(urlSuffix)){const callback=<span class="cstat-no" title="statement not covered" >sourceMapCallbacks.get(urlSuffix);<span class="cstat-no" title="statement not covered" ></span>callback.call(null);<span class="cstat-no" title="statement not covered" >s</span>ourceMapCallbacks.delete(urlSuffix);}</span>}</span>}</span>
<span class="cstat-no" title="statement not covered" >BindingsTestRunner.waitForSourceMap=<span class="fstat-no" title="function not covered" >fu</span>nction(sourceMapURLSuffix){let fulfill;const promise=<span class="cstat-no" title="statement not covered" >new Promise(<span class="fstat-no" title="function not covered" >x=</span>&gt;<span class="cstat-no" title="statement not covered" >fulfill=x)</span>;<span class="cstat-no" title="statement not covered" ></span>sourceMapCallbacks.set(sourceMapURLSuffix,fulfill);<span class="cstat-no" title="statement not covered" >r</span>eturn promise;}</span>;c</span>onst locationPool=<span class="cstat-no" title="statement not covered" >new Bindings.LiveLocationPool();</span>const nameSymbol=<span class="cstat-no" title="statement not covered" >Symbol('LiveLocationNameForTest');</span>const createdSymbol=<span class="cstat-no" title="statement not covered" >Symbol('LiveLocationCreated');<span class="cstat-no" title="statement not covered" ></span>BindingsTestRunner.createDebuggerLiveLocation=<span class="fstat-no" title="function not covered" >fu</span>nction(name,urlSuffix,lineNumber,columnNumber){const script=<span class="cstat-no" title="statement not covered" >TestRunner.debuggerModel.scripts().find(<span class="fstat-no" title="function not covered" >sc</span>ript=&gt;<span class="cstat-no" title="statement not covered" >script.sourceURL.endsWith(urlSuffix))</span>;</span>const rawLocation=<span class="cstat-no" title="statement not covered" >TestRunner.debuggerModel.createRawLocation(script,lineNumber||0,columnNumber||0);<span class="cstat-no" title="statement not covered" ></span>return Bindings.debuggerWorkspaceBinding.createLiveLocation(rawLocation,updateDelegate.bind(null,name),locationPool);}</span>;<span class="cstat-no" title="statement not covered" >B</span>indingsTestRunner.createCSSLiveLocation=<span class="fstat-no" title="function not covered" >fu</span>nction(name,urlSuffix,lineNumber,columnNumber){const header=<span class="cstat-no" title="statement not covered" >TestRunner.cssModel.styleSheetHeaders().find(<span class="fstat-no" title="function not covered" >he</span>ader=&gt;<span class="cstat-no" title="statement not covered" >header.resourceURL().endsWith(urlSuffix))</span>;</span>const rawLocation=<span class="cstat-no" title="statement not covered" >new SDK.CSSLocation(header,lineNumber||0,columnNumber||0);<span class="cstat-no" title="statement not covered" ></span>return Bindings.cssWorkspaceBinding.createLiveLocation(rawLocation,updateDelegate.bind(null,name),locationPool);}</span>;f</span>unction <span class="fstat-no" title="function not covered" >updateDelegate(</span>name,liveLocation){<span class="cstat-no" title="statement not covered" >liveLocation[nameSymbol]=name;c</span>onst hint=(<span class="cstat-no" title="statement not covered" >liveLocation[createdSymbol]?'[ UPDATE ]':'[ CREATE ]')</span>;<span class="cstat-no" title="statement not covered" >liveLocation[createdSymbol]=true;<span class="cstat-no" title="statement not covered" >B</span>indingsTestRunner.dumpLocation(liveLocation,hint);}</span>
<span class="cstat-no" title="statement not covered" >BindingsTestRunner.dumpLocation=<span class="fstat-no" title="function not covered" >fu</span>nction(liveLocation,hint){<span class="cstat-no" title="statement not covered" >hint=hint||'[  GET   ]';c</span>onst prefix=<span class="cstat-no" title="statement not covered" >`${hint}  LiveLocation-${liveLocation[nameSymbol]}: `;</span>const uiLocation=<span class="cstat-no" title="statement not covered" >liveLocation.uiLocation();<span class="cstat-no" title="statement not covered" ></span>if(!uiLocation){<span class="cstat-no" title="statement not covered" >TestRunner.addResult(prefix+'null');<span class="cstat-no" title="statement not covered" >r</span>eturn;}</span></span></span>
<span class="cstat-no" title="statement not covered" >TestRunner.addResult(prefix+BindingsTestRunner.cleanupURL(uiLocation.uiSourceCode.url())+':'+uiLocation.lineNumber+':'+</span>
uiLocation.columnNumber);};;<span class="cstat-no" title="statement not covered" >InspectorFrontendHost.isolatedFileSystem=<span class="fstat-no" title="function not covered" >fu</span>nction(name){<span class="cstat-no" title="statement not covered" >return BindingsTestRunner.TestFileSystem._instances[name];}</span>;<span class="cstat-no" title="statement not covered" >B</span>indingsTestRunner.TestFileSystem=<span class="fstat-no" title="function not covered" >fu</span>nction(fileSystemPath){<span class="cstat-no" title="statement not covered" >this.root=new BindingsTestRunner.TestFileSystem.Entry(this,'',true,null);<span class="cstat-no" title="statement not covered" >t</span>his.fileSystemPath=fileSystemPath;}</span>;<span class="cstat-no" title="statement not covered" >B</span>indingsTestRunner.TestFileSystem._instances={};<span class="cstat-no" title="statement not covered" >B</span>indingsTestRunner.TestFileSystem.prototype={dumpAsText:<span class="fstat-no" title="function not covered" >fu</span>nction(){const result=<span class="cstat-no" title="statement not covered" >[];<span class="cstat-no" title="statement not covered" ></span>dfs(this.root,'');<span class="cstat-no" title="statement not covered" >r</span>esult[0]=this.fileSystemPath;<span class="cstat-no" title="statement not covered" >r</span>eturn result.join('\n');f</span>unction <span class="fstat-no" title="function not covered" >dfs(</span>node,indent){<span class="cstat-no" title="statement not covered" >result.push(indent+node.name);c</span>onst newIndent=<span class="cstat-no" title="statement not covered" >indent+'    ';<span class="cstat-no" title="statement not covered" ></span>for(const child of node._children)</span></span>
<span class="cstat-no" title="statement not covered" >dfs(child,newIndent);}</span>},reportCreatedPromise:<span class="fstat-no" title="function not covered" >fu</span>nction(type){<span class="cstat-no" title="statement not covered" >return new Promise(<span class="fstat-no" title="function not covered" >fu</span>lfill=&gt;<span class="cstat-no" title="statement not covered" >this.reportCreated(fulfill,type))</span>;}</span>,reportCreated:<span class="fstat-no" title="function not covered" >fu</span>nction(callback,type){const fileSystemPath=<span class="cstat-no" title="statement not covered" >this.fileSystemPath;<span class="cstat-no" title="statement not covered" ></span>BindingsTestRunner.TestFileSystem._instances[this.fileSystemPath]=this;<span class="cstat-no" title="statement not covered" >I</span>nspectorFrontendHost.events.dispatchEventToListeners(InspectorFrontendHostAPI.Events.FileSystemAdded,{fileSystem:{fileSystemPath:this.fileSystemPath,fileSystemName:this.fileSystemPath,type}});<span class="cstat-no" title="statement not covered" >P</span>ersistence.isolatedFileSystemManager.addEventListener(Persistence.IsolatedFileSystemManager.Events.FileSystemAdded,created);f</span>unction <span class="fstat-no" title="function not covered" >created(</span>event){const fileSystem=<span class="cstat-no" title="statement not covered" >event.data;<span class="cstat-no" title="statement not covered" ></span>if(fileSystem.path()!==fileSystemPath)</span>
<span class="cstat-no" title="statement not covered" >return;<span class="cstat-no" title="statement not covered" >P</span>ersistence.isolatedFileSystemManager.removeEventListener(Persistence.IsolatedFileSystemManager.Events.FileSystemAdded,created);<span class="cstat-no" title="statement not covered" >c</span>allback(fileSystem);}</span>},reportRemoved:<span class="fstat-no" title="function not covered" >fu</span>nction(){<span class="cstat-no" title="statement not covered" >delete BindingsTestRunner.TestFileSystem._instances[this.fileSystemPath];<span class="cstat-no" title="statement not covered" >I</span>nspectorFrontendHost.events.dispatchEventToListeners(InspectorFrontendHostAPI.Events.FileSystemRemoved,this.fileSystemPath);}</span>,addFile:<span class="fstat-no" title="function not covered" >fu</span>nction(path,content,lastModified){const pathTokens=<span class="cstat-no" title="statement not covered" >path.split('/');</span>let node=<span class="cstat-no" title="statement not covered" >this.root;</span>const folders=<span class="cstat-no" title="statement not covered" >pathTokens.slice(0,pathTokens.length-1);</span>const fileName=<span class="cstat-no" title="statement not covered" >pathTokens.peekLast();<span class="cstat-no" title="statement not covered" ></span>for(const folder of folders){let dir=<span class="cstat-no" title="statement not covered" >node._childrenMap[folder];<span class="cstat-no" title="statement not covered" ></span>if(!dir)</span></span>
<span class="cstat-no" title="statement not covered" >dir=node.mkdir(folder);<span class="cstat-no" title="statement not covered" >n</span>ode=dir;}</span>
const file=<span class="cstat-no" title="statement not covered" >node.addFile(fileName,content);<span class="cstat-no" title="statement not covered" ></span>if(lastModified)</span>
<span class="cstat-no" title="statement not covered" >file._timestamp=lastModified;<span class="cstat-no" title="statement not covered" >r</span>eturn file;}</span>};<span class="cstat-no" title="statement not covered" >BindingsTestRunner.TestFileSystem.Entry=<span class="fstat-no" title="function not covered" >fu</span>nction(fileSystem,name,isDirectory,parent){<span class="cstat-no" title="statement not covered" >this._fileSystem=fileSystem;<span class="cstat-no" title="statement not covered" >t</span>his.name=name;<span class="cstat-no" title="statement not covered" >t</span>his._children=[];<span class="cstat-no" title="statement not covered" >t</span>his._childrenMap={};<span class="cstat-no" title="statement not covered" >t</span>his.isDirectory=isDirectory;<span class="cstat-no" title="statement not covered" >t</span>his._timestamp=1000000;<span class="cstat-no" title="statement not covered" >t</span>his._parent=parent;}</span>;<span class="cstat-no" title="statement not covered" >B</span>indingsTestRunner.TestFileSystem.Entry.prototype={get fullPath(){<span class="cstat-no" title="statement not covered" >return(this.parent?this.parent.fullPath+'/'+this.name:'');}</span>,remove:<span class="fstat-no" title="function not covered" >fu</span>nction(success,failure){<span class="cstat-no" title="statement not covered" >this._parent._removeChild(this,success,failure);}</span>,_removeChild:<span class="fstat-no" title="function not covered" >fu</span>nction(child,success,failure){const index=<span class="cstat-no" title="statement not covered" >this._children.indexOf(child);<span class="cstat-no" title="statement not covered" ></span>if(index===-1){<span class="cstat-no" title="statement not covered" >failure('Failed to remove file: file not found.');<span class="cstat-no" title="statement not covered" >r</span>eturn;}</span></span></span>
const fullPath=<span class="cstat-no" title="statement not covered" >this._fileSystem.fileSystemPath+child.fullPath;<span class="cstat-no" title="statement not covered" ></span>this._children.splice(index,1);<span class="cstat-no" title="statement not covered" >d</span>elete this._childrenMap[child.name];<span class="cstat-no" title="statement not covered" >c</span>hild.parent=null;<span class="cstat-no" title="statement not covered" >I</span>nspectorFrontendHost.events.dispatchEventToListeners(InspectorFrontendHostAPI.Events.FileSystemFilesChangedAddedRemoved,{changed:[],added:[],removed:[fullPath]});<span class="cstat-no" title="statement not covered" >s</span>uccess();}</span>,mkdir:<span class="fstat-no" title="function not covered" >fu</span>nction(name){const child=<span class="cstat-no" title="statement not covered" >new BindingsTestRunner.TestFileSystem.Entry(this._fileSystem,name,true,this);<span class="cstat-no" title="statement not covered" ></span>this._childrenMap[name]=child;<span class="cstat-no" title="statement not covered" >t</span>his._children.push(child);<span class="cstat-no" title="statement not covered" >c</span>hild.parent=this;<span class="cstat-no" title="statement not covered" >r</span>eturn child;}</span>,addFile:<span class="fstat-no" title="function not covered" >fu</span>nction(name,content){const child=<span class="cstat-no" title="statement not covered" >new BindingsTestRunner.TestFileSystem.Entry(this._fileSystem,name,false,this);<span class="cstat-no" title="statement not covered" ></span>this._childrenMap[name]=child;<span class="cstat-no" title="statement not covered" >t</span>his._children.push(child);<span class="cstat-no" title="statement not covered" >c</span>hild.parent=this;<span class="cstat-no" title="statement not covered" >c</span>hild.content=new Blob([content],{type:'text/plain'});c</span>onst fullPath=<span class="cstat-no" title="statement not covered" >this._fileSystem.fileSystemPath+child.fullPath;<span class="cstat-no" title="statement not covered" ></span>InspectorFrontendHost.events.dispatchEventToListeners(InspectorFrontendHostAPI.Events.FileSystemFilesChangedAddedRemoved,{changed:[],added:[fullPath],removed:[]});<span class="cstat-no" title="statement not covered" >r</span>eturn child;}</span>,setContent:<span class="fstat-no" title="function not covered" >fu</span>nction(content){<span class="cstat-no" title="statement not covered" >this.content=new Blob([content],{type:'text/plain'});<span class="cstat-no" title="statement not covered" >t</span>his._timestamp+=1000;c</span>onst fullPath=<span class="cstat-no" title="statement not covered" >this._fileSystem.fileSystemPath+this.fullPath;<span class="cstat-no" title="statement not covered" ></span>InspectorFrontendHost.events.dispatchEventToListeners(InspectorFrontendHostAPI.Events.FileSystemFilesChangedAddedRemoved,{changed:[fullPath],added:[],removed:[]});}</span>,createReader:<span class="fstat-no" title="function not covered" >fu</span>nction(){<span class="cstat-no" title="statement not covered" >return new BindingsTestRunner.TestFileSystem.Reader(this._children);}</span>,createWriter:<span class="fstat-no" title="function not covered" >fu</span>nction(success,failure){<span class="cstat-no" title="statement not covered" >success(new BindingsTestRunner.TestFileSystem.Writer(this));}</span>,file:<span class="fstat-no" title="function not covered" >fu</span>nction(callback){<span class="cstat-no" title="statement not covered" >callback(this.content);}</span>,getDirectory:<span class="fstat-no" title="function not covered" >fu</span>nction(path,noop,callback,errorCallback){<span class="cstat-no" title="statement not covered" >this.getEntry(path,noop,callback,errorCallback);}</span>,getFile:<span class="fstat-no" title="function not covered" >fu</span>nction(path,noop,callback,errorCallback){<span class="cstat-no" title="statement not covered" >this.getEntry(path,noop,callback,errorCallback);}</span>,_createEntry:<span class="fstat-no" title="function not covered" >fu</span>nction(path,options,callback,errorCallback){const tokens=<span class="cstat-no" title="statement not covered" >path.split('/');</span>const name=<span class="cstat-no" title="statement not covered" >tokens.pop();</span>let parentEntry=<span class="cstat-no" title="statement not covered" >this;<span class="cstat-no" title="statement not covered" ></span>for(const token of tokens)</span>
<span class="cstat-no" title="statement not covered" >parentEntry=parentEntry._childrenMap[token];l</span>et entry=<span class="cstat-no" title="statement not covered" >parentEntry._childrenMap[name];<span class="cstat-no" title="statement not covered" ></span>if(entry&amp;&amp;options.exclusive){<span class="cstat-no" title="statement not covered" >errorCallback(new DOMException('File exists: '+path,'InvalidModificationError'));<span class="cstat-no" title="statement not covered" >r</span>eturn;}</span></span>
<span class="cstat-no" title="statement not covered" >if(!entry)</span>
<span class="cstat-no" title="statement not covered" >entry=parentEntry.addFile(name,'');<span class="cstat-no" title="statement not covered" >c</span>allback(entry);}</span>,getEntry:<span class="fstat-no" title="function not covered" >fu</span>nction(path,options,callback,errorCallback){<span class="cstat-no" title="statement not covered" >if(path.startsWith('/'))</span>
<span class="cstat-no" title="statement not covered" >path=path.substring(1);<span class="cstat-no" title="statement not covered" >i</span>f(options&amp;&amp;options.create){<span class="cstat-no" title="statement not covered" >this._createEntry(path,options,callback,errorCallback);<span class="cstat-no" title="statement not covered" >r</span>eturn;}</span></span>
<span class="cstat-no" title="statement not covered" >if(!path){<span class="cstat-no" title="statement not covered" >callback(this);<span class="cstat-no" title="statement not covered" >r</span>eturn;}</span></span>
let entry=<span class="cstat-no" title="statement not covered" >this;<span class="cstat-no" title="statement not covered" ></span>for(const token of path.split('/')){<span class="cstat-no" title="statement not covered" >entry=entry._childrenMap[token];<span class="cstat-no" title="statement not covered" >i</span>f(!entry)</span></span>
<span class="cstat-no" title="statement not covered" >break;}</span>
<span class="cstat-no" title="statement not covered" >(entry?callback(entry):errorCallback(new DOMException('Path not found: '+path,'NotFoundError')));}</span>,getMetadata:<span class="fstat-no" title="function not covered" >fu</span>nction(success,failure){<span class="cstat-no" title="statement not covered" >success({modificationTime:new Date(this._timestamp),size:(this.isDirectory?0:this.content.size)});}</span>,moveTo:<span class="fstat-no" title="function not covered" >fu</span>nction(parent,newName,callback,errorCallback){<span class="cstat-no" title="statement not covered" >this._parent._children.remove(this);<span class="cstat-no" title="statement not covered" >d</span>elete this._parent._childrenMap[this.name];<span class="cstat-no" title="statement not covered" >t</span>his._parent=parent;<span class="cstat-no" title="statement not covered" >t</span>his._parent._children.push(this);<span class="cstat-no" title="statement not covered" >t</span>his.name=newName;<span class="cstat-no" title="statement not covered" >t</span>his._parent._childrenMap[this.name]=this;<span class="cstat-no" title="statement not covered" >c</span>allback(this);}</span>,getParent:<span class="fstat-no" title="function not covered" >fu</span>nction(callback,errorCallback){<span class="cstat-no" title="statement not covered" >callback(this._parent);}</span>};<span class="cstat-no" title="statement not covered" >BindingsTestRunner.TestFileSystem.Reader=<span class="fstat-no" title="function not covered" >fu</span>nction(children){<span class="cstat-no" title="statement not covered" >this._children=children;}</span>;<span class="cstat-no" title="statement not covered" >B</span>indingsTestRunner.TestFileSystem.Reader.prototype={readEntries:<span class="fstat-no" title="function not covered" >fu</span>nction(callback){const children=<span class="cstat-no" title="statement not covered" >this._children;<span class="cstat-no" title="statement not covered" ></span>this._children=[];<span class="cstat-no" title="statement not covered" >c</span>allback(children);}</span>};<span class="cstat-no" title="statement not covered" >B</span>indingsTestRunner.TestFileSystem.Writer=<span class="fstat-no" title="function not covered" >fu</span>nction(entry){<span class="cstat-no" title="statement not covered" >this._entry=entry;<span class="cstat-no" title="statement not covered" >t</span>his._modificationTimesDelta=500;}</span>;<span class="cstat-no" title="statement not covered" >B</span>indingsTestRunner.TestFileSystem.Writer.prototype={write:<span class="fstat-no" title="function not covered" >fu</span>nction(blob){<span class="cstat-no" title="statement not covered" >this._entry._timestamp+=this._modificationTimesDelta;<span class="cstat-no" title="statement not covered" >t</span>his._entry.content=blob;<span class="cstat-no" title="statement not covered" >i</span>f(this.onwriteend)</span></span>
<span class="cstat-no" title="statement not covered" >this.onwriteend();}</span>,truncate:<span class="fstat-no" title="function not covered" >fu</span>nction(num){<span class="cstat-no" title="statement not covered" >this._entry._timestamp+=this._modificationTimesDelta;<span class="cstat-no" title="statement not covered" >t</span>his._entry.content=this._entry.content.slice(0,num);<span class="cstat-no" title="statement not covered" >i</span>f(this.onwriteend)</span>
<span class="cstat-no" title="statement not covered" >this.onwriteend();}</span>};;<span class="cstat-no" title="statement not covered" >BindingsTestRunner.addFiles=<span class="fstat-no" title="function not covered" >fu</span>nction(testFileSystem,files){<span class="cstat-no" title="statement not covered" >for(const filePath in files){const file=<span class="cstat-no" title="statement not covered" >files[filePath];<span class="cstat-no" title="statement not covered" ></span>testFileSystem.addFile(filePath,file.content,(file.time?file.time.getTime():0));}</span>}</span>;l</span>et timeOverrides;let originalRequestMetadata;<span class="cstat-no" title="statement not covered" >BindingsTestRunner.overrideNetworkModificationTime=<span class="fstat-no" title="function not covered" >fu</span>nction(urlToTime){<span class="cstat-no" title="statement not covered" >if(!timeOverrides){<span class="cstat-no" title="statement not covered" >timeOverrides=new Map();<span class="cstat-no" title="statement not covered" >o</span>riginalRequestMetadata=TestRunner.override(Bindings.ContentProviderBasedProject.prototype,'requestMetadata',overrideTime,true);}</span></span></span>
<span class="cstat-no" title="statement not covered" >for(const url in urlToTime)</span>
<span class="cstat-no" title="statement not covered" >timeOverrides.set(url,urlToTime[url]);f</span>unction <span class="fstat-no" title="function not covered" >overrideTime(</span>uiSourceCode){<span class="cstat-no" title="statement not covered" >if(!timeOverrides.has(uiSourceCode.url()))</span>
<span class="cstat-no" title="statement not covered" >return originalRequestMetadata.call(this,uiSourceCode);c</span>onst override=<span class="cstat-no" title="statement not covered" >timeOverrides.get(uiSourceCode.url());<span class="cstat-no" title="statement not covered" ></span>return originalRequestMetadata.call(this,uiSourceCode).then(onOriginalMetadata.bind(null,override));}</span>
function <span class="fstat-no" title="function not covered" >onOriginalMetadata(</span>timeOverride,metadata){<span class="cstat-no" title="statement not covered" >if(!timeOverride&amp;&amp;!metadata)</span>
<span class="cstat-no" title="statement not covered" >return null;<span class="cstat-no" title="statement not covered" >r</span>eturn new Workspace.UISourceCodeMetadata(timeOverride,(metadata?metadata.contentSize:null));}</span>};<span class="cstat-no" title="statement not covered" >BindingsTestRunner.AutomappingTest=<span class="fstat-no" title="function not covered" >fu</span>nction(workspace){<span class="cstat-no" title="statement not covered" >this._workspace=workspace;<span class="cstat-no" title="statement not covered" >t</span>his._networkProject=new Bindings.ContentProviderBasedProject(this._workspace,'AUTOMAPPING',Workspace.projectTypes.Network,'simple website');<span class="cstat-no" title="statement not covered" >i</span>f(workspace!==Workspace.workspace)</span></span>
<span class="cstat-no" title="statement not covered" >new Persistence.FileSystemWorkspaceBinding(Persistence.isolatedFileSystemManager,this._workspace);<span class="cstat-no" title="statement not covered" >t</span>his._failedBindingsCount=0;<span class="cstat-no" title="statement not covered" >t</span>his._automapping=new Persistence.Automapping(this._workspace,this._onStatusAdded.bind(this),this._onStatusRemoved.bind(this));<span class="cstat-no" title="statement not covered" >T</span>estRunner.addSniffer(this._automapping,'_onBindingFailedForTest',this._onBindingFailed.bind(this),true);<span class="cstat-no" title="statement not covered" >T</span>estRunner.addSniffer(this._automapping,'_onSweepHappenedForTest',this._onSweepHappened.bind(this),true);}</span>;<span class="cstat-no" title="statement not covered" >BindingsTestRunner.AutomappingTest.prototype={removeResources:<span class="fstat-no" title="function not covered" >fu</span>nction(urls){<span class="cstat-no" title="statement not covered" >for(const url of urls)</span></span>
<span class="cstat-no" title="statement not covered" >this._networkProject.removeFile(url);}</span>,addNetworkResources:<span class="fstat-no" title="function not covered" >fu</span>nction(assets){<span class="cstat-no" title="statement not covered" >for(const url in assets){const asset=<span class="cstat-no" title="statement not covered" >assets[url];</span>const contentType=<span class="cstat-no" title="statement not covered" >asset.contentType||Common.resourceTypes.Script;</span>const contentProvider=<span class="cstat-no" title="statement not covered" >Common.StaticContentProvider.fromString(url,contentType,asset.content);</span>const metadata=(<span class="cstat-no" title="statement not covered" >typeof asset.content==='string'||asset.time?new Workspace.UISourceCodeMetadata(asset.time,asset.content.length):null)</span>;const uiSourceCode=<span class="cstat-no" title="statement not covered" >this._networkProject.createUISourceCode(url,contentType);<span class="cstat-no" title="statement not covered" ></span>this._networkProject.addUISourceCodeWithProvider(uiSourceCode,contentProvider,metadata);}</span>}</span>,waitUntilMappingIsStabilized:<span class="fstat-no" title="function not covered" >fu</span>nction(){const promise=<span class="cstat-no" title="statement not covered" >new Promise(<span class="fstat-no" title="function not covered" >x=</span>&gt;<span class="cstat-no" title="statement not covered" >this._stabilizedCallback=x)</span>;<span class="cstat-no" title="statement not covered" ></span>this._checkStabilized();<span class="cstat-no" title="statement not covered" >r</span>eturn promise;}</span>,_onSweepHappened:<span class="fstat-no" title="function not covered" >fu</span>nction(){<span class="cstat-no" title="statement not covered" >this._failedBindingsCount=0;<span class="cstat-no" title="statement not covered" >t</span>his._checkStabilized();}</span>,_onStatusRemoved:<span class="fstat-no" title="function not covered" >fu</span>nction(status){<span class="cstat-no" title="statement not covered" >TestRunner.addResult('Binding removed: '+status);<span class="cstat-no" title="statement not covered" >t</span>his._checkStabilized();}</span>,_onStatusAdded:<span class="fstat-no" title="function not covered" >fu</span>nction(status){<span class="cstat-no" title="statement not covered" >TestRunner.addResult('Binding created: '+status);<span class="cstat-no" title="statement not covered" >t</span>his._checkStabilized();}</span>,_onBindingFailed:<span class="fstat-no" title="function not covered" >fu</span>nction(){<span class="cstat-no" title="statement not covered" >++this._failedBindingsCount;<span class="cstat-no" title="statement not covered" >t</span>his._checkStabilized();}</span>,_checkStabilized:<span class="fstat-no" title="function not covered" >fu</span>nction(){<span class="cstat-no" title="statement not covered" >if(!this._stabilizedCallback||this._automapping._sweepThrottler._process)</span>
<span class="cstat-no" title="statement not covered" >return;c</span>onst networkUISourceCodes=<span class="cstat-no" title="statement not covered" >this._workspace.uiSourceCodesForProjectType(Workspace.projectTypes.Network);</span>const stabilized=<span class="cstat-no" title="statement not covered" >this._failedBindingsCount+this._automapping._statuses.size===networkUISourceCodes.length;<span class="cstat-no" title="statement not covered" ></span>if(stabilized){<span class="cstat-no" title="statement not covered" >TestRunner.addResult('Mapping has stabilized.');c</span>onst callback=<span class="cstat-no" title="statement not covered" >this._stabilizedCallback;<span class="cstat-no" title="statement not covered" ></span>delete this._stabilizedCallback;<span class="cstat-no" title="statement not covered" >c</span>allback.call(null);}</span>}</span>};;<span class="cstat-no" title="statement not covered" >Persistence.PersistenceBinding.prototype.toString=<span class="fstat-no" title="function not covered" >fu</span>nction(){const lines=<span class="cstat-no" title="statement not covered" >['{','       network: '+this.network.url(),'    fileSystem: '+this.fileSystem.url(),'}'];<span class="cstat-no" title="statement not covered" ></span>return lines.join('\n');}</span>;<span class="cstat-no" title="statement not covered" >P</span>ersistence.AutomappingStatus.prototype.toString=<span class="fstat-no" title="function not covered" >fu</span>nction(){const lines=<span class="cstat-no" title="statement not covered" >['{','       network: '+this.network.url(),'    fileSystem: '+this.fileSystem.url(),'    exactMatch: '+this.exactMatch,'}'];<span class="cstat-no" title="statement not covered" ></span>return lines.join('\n');}</span>;<span class="cstat-no" title="statement not covered" >B</span>indingsTestRunner.waitForBinding=<span class="fstat-no" title="function not covered" >fu</span>nction(fileName){const uiSourceCodes=<span class="cstat-no" title="statement not covered" >Workspace.workspace.uiSourceCodes();<span class="cstat-no" title="statement not covered" ></span>for(const uiSourceCode of uiSourceCodes){const binding=<span class="cstat-no" title="statement not covered" >Persistence.persistence.binding(uiSourceCode);<span class="cstat-no" title="statement not covered" ></span>if(!binding)</span></span></span>
<span class="cstat-no" title="statement not covered" >continue;<span class="cstat-no" title="statement not covered" >i</span>f(uiSourceCode.name()===fileName)</span>
<span class="cstat-no" title="statement not covered" >return Promise.resolve(binding);}</span>
<span class="cstat-no" title="statement not covered" >return TestRunner.waitForEvent(Persistence.Persistence.Events.BindingCreated,Persistence.persistence,<span class="fstat-no" title="function not covered" >bi</span>nding=&gt;<span class="cstat-no" title="statement not covered" >binding.network.name()===fileName||binding.fileSystem.name()===fileName)</span>;}</span>;<span class="cstat-no" title="statement not covered" >BindingsTestRunner.addFooJSFile=<span class="fstat-no" title="function not covered" >fu</span>nction(fs){<span class="cstat-no" title="statement not covered" >return fs.root.mkdir('devtools').mkdir('persistence').mkdir('resources').addFile('foo.js','\n\nwindow.foo = ()=&gt;\'foo\';\n');}</span>;<span class="cstat-no" title="statement not covered" >B</span>indingsTestRunner.initializeTestMapping=<span class="fstat-no" title="function not covered" >fu</span>nction(){<span class="cstat-no" title="statement not covered" >return new TestMapping(Persistence.persistence);}</span>;c</span>lass TestMapping{<span class="fstat-no" title="function not covered" >co</span>nstructor(persistence){<span class="cstat-no" title="statement not covered" >this._persistence=persistence;<span class="cstat-no" title="statement not covered" >p</span>ersistence.setAutomappingEnabled(false);<span class="cstat-no" title="statement not covered" >t</span>his._bindings=new Set();}</span>
<span class="fstat-no" title="function not covered" >as</span>ync addBinding(urlSuffix){<span class="cstat-no" title="statement not covered" >if(this._findBinding(urlSuffix)){<span class="cstat-no" title="statement not covered" >TestRunner.addResult(`FAILED TO ADD BINDING: binding already exists for ${urlSuffix}`);<span class="cstat-no" title="statement not covered" >T</span>estRunner.completeTest();<span class="cstat-no" title="statement not covered" >r</span>eturn;}</span></span>
const networkUISourceCode=<span class="cstat-no" title="statement not covered" >await TestRunner.waitForUISourceCode(urlSuffix,Workspace.projectTypes.Network);</span>const fileSystemUISourceCode=<span class="cstat-no" title="statement not covered" >await TestRunner.waitForUISourceCode(urlSuffix,Workspace.projectTypes.FileSystem);</span>const binding=<span class="cstat-no" title="statement not covered" >new Persistence.PersistenceBinding(networkUISourceCode,fileSystemUISourceCode);<span class="cstat-no" title="statement not covered" ></span>this._bindings.add(binding);<span class="cstat-no" title="statement not covered" >t</span>his._persistence.addBindingForTest(binding);}</span>
<span class="fstat-no" title="function not covered" >_f</span>indBinding(urlSuffix){<span class="cstat-no" title="statement not covered" >for(const binding of this._bindings){<span class="cstat-no" title="statement not covered" >if(binding.network.url().endsWith(urlSuffix))</span></span>
<span class="cstat-no" title="statement not covered" >return binding;}</span>
<span class="cstat-no" title="statement not covered" >return null;}</span>
<span class="fstat-no" title="function not covered" >as</span>ync removeBinding(urlSuffix){const binding=<span class="cstat-no" title="statement not covered" >this._findBinding(urlSuffix);<span class="cstat-no" title="statement not covered" ></span>if(!binding){<span class="cstat-no" title="statement not covered" >TestRunner.addResult(`FAILED TO REMOVE BINDING: binding does not exist for ${urlSuffix}`);<span class="cstat-no" title="statement not covered" >T</span>estRunner.completeTest();<span class="cstat-no" title="statement not covered" >r</span>eturn;}</span></span>
<span class="cstat-no" title="statement not covered" >this._bindings.delete(binding);<span class="cstat-no" title="statement not covered" >t</span>his._persistence.removeBindingForTest(binding);}</span>
<span class="fstat-no" title="function not covered" >di</span>spose(){<span class="cstat-no" title="statement not covered" >for(const binding of this._bindings)</span>
<span class="cstat-no" title="statement not covered" >this._persistence.removeBindingForTest(binding);<span class="cstat-no" title="statement not covered" >t</span>his._bindings.clear();}</span>};<span class="cstat-no" title="statement not covered" >BindingsTestRunner.createOverrideProject=<span class="fstat-no" title="function not covered" >as</span>ync function(folderPath){const testFileSystem=<span class="cstat-no" title="statement not covered" >new BindingsTestRunner.TestFileSystem(folderPath);</span>const isolatedFileSystem=<span class="cstat-no" title="statement not covered" >await testFileSystem.reportCreatedPromise('overrides');<span class="cstat-no" title="statement not covered" ></span>isolatedFileSystem._type='overrides';c</span>onst project=<span class="cstat-no" title="statement not covered" >Workspace.workspace.project(Persistence.FileSystemWorkspaceBinding.projectId(isolatedFileSystem.path()));<span class="cstat-no" title="statement not covered" ></span>console.assert(project);<span class="cstat-no" title="statement not covered" >r</span>eturn{isolatedFileSystem,project,testFileSystem};}</span>;<span class="cstat-no" title="statement not covered" >B</span>indingsTestRunner.setOverridesEnabled=<span class="fstat-no" title="function not covered" >fu</span>nction(enabled){<span class="cstat-no" title="statement not covered" >Common.settings.moduleSetting('persistenceNetworkOverridesEnabled').set(enabled);}</span>;;</span></pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="https://istanbul.js.org/" target="_blank">istanbul</a> at Wed May 15 2019 19:03:43 GMT+0800 (China Standard Time)
</div>
</div>
<script src="../../../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../../../sorter.js"></script>
<script src="../../../../../block-navigation.js"></script>
</body>
</html>
